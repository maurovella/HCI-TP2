var _0x3bac=['name','inflateDto','update','_id','remove','find','inflateDtos','findOne','actions','map','devices','retrieveById','device','state','all','then','join','config','general','paths','dbName','log',']...','ensureIndex','error','routine\x20database\x20loaded','nedb','path','exports','routines','routines.db','models','routine','toDto','insert','context'];(function(_0x1587a6,_0x285ded){var _0x163f51=function(_0x4ce3e8){while(--_0x4ce3e8){_0x1587a6['push'](_0x1587a6['shift']());}};_0x163f51(++_0x285ded);}(_0x3bac,0xce));var _0x49dc=function(_0x1d211e,_0xcd9238){_0x1d211e=_0x1d211e-0x0;var _0x566b5b=_0x3bac[_0x1d211e];return _0x566b5b;};'use strict';var Datastore=require(_0x49dc('0x0'));var Path=require(_0x49dc('0x1'));module[_0x49dc('0x2')]={'initialize':function(_0x48a895,_0x23ce82){_0x48a895[_0x49dc('0x3')]={'dbName':_0x49dc('0x4'),'create':function(_0x4cdae7){return new Promise((_0x3d3c0f,_0x2dad61)=>{var _0xc83f41=_0x48a895[_0x49dc('0x5')][_0x49dc('0x6')][_0x49dc('0x7')](_0x4cdae7);_0x48a895['db']['routines'][_0x49dc('0x8')](_0xc83f41,(_0x42b60e,_0x2af87d)=>{if(_0x42b60e){_0x42b60e[_0x49dc('0x9')]={'entity':{'type':'routine','id':_0xc83f41[_0x49dc('0xa')]}};_0x2dad61(_0x42b60e);}else{_0x3d3c0f(_0x48a895['routines'][_0x49dc('0xb')](_0x2af87d));}});});},'update':function(_0x24c3cd){return new Promise((_0x55c136,_0x25a08b)=>{var _0x27191a=_0x48a895[_0x49dc('0x5')]['routine'][_0x49dc('0x7')](_0x24c3cd);_0x48a895['db'][_0x49dc('0x3')][_0x49dc('0xc')]({'_id':_0x27191a[_0x49dc('0xd')]},_0x27191a,{},(_0x521b20,_0x5120c5)=>{if(_0x521b20){_0x521b20[_0x49dc('0x9')]={'entity':{'type':_0x49dc('0x6'),'id':_0x27191a[_0x49dc('0xa')]}};_0x25a08b(_0x521b20);}else{_0x55c136(_0x5120c5==0x1);}});});},'delete':function(_0x29fb8f){return new Promise((_0x3bf227,_0x14dea5)=>{_0x48a895['db'][_0x49dc('0x3')][_0x49dc('0xe')]({'_id':_0x29fb8f},{},(_0x560aad,_0x5867a4)=>{if(_0x560aad){_0x14dea5(_0x560aad);}else{_0x3bf227(_0x5867a4==0x1);}});});},'retrieveAll':function(){return new Promise((_0x29f388,_0x1151fb)=>{_0x48a895['db']['routines'][_0x49dc('0xf')]({},(_0x5b5176,_0x216057)=>{if(_0x5b5176){_0x1151fb(_0x5b5176);}else{_0x29f388(_0x48a895[_0x49dc('0x3')][_0x49dc('0x10')](_0x216057));}});});},'retrieveById':function(_0x3b11b1){return new Promise((_0x476bf4,_0x588569)=>{_0x48a895['db'][_0x49dc('0x3')][_0x49dc('0x11')]({'_id':_0x3b11b1},(_0x18f98d,_0x238130)=>{if(_0x18f98d){_0x588569(_0x18f98d);}else{_0x476bf4(_0x48a895[_0x49dc('0x3')][_0x49dc('0xb')](_0x238130));}});});},'inflateDto':function(_0x36c1fd){return new Promise((_0x42e950,_0x42a051)=>{if(!_0x36c1fd)_0x42e950(null);else{var _0x317621=_0x36c1fd[_0x49dc('0x12')][_0x49dc('0x13')](_0x5b387f=>{return new Promise((_0x42e950,_0x42a051)=>{_0x48a895[_0x49dc('0x14')][_0x49dc('0x15')](_0x5b387f['device']['id'])['then'](_0x121b55=>{if(!_0x121b55)_0x42e950(null);else{_0x5b387f[_0x49dc('0x16')]=_0x121b55;delete _0x5b387f[_0x49dc('0x16')][_0x49dc('0x17')];_0x42e950(_0x5b387f);}});});});Promise[_0x49dc('0x18')](_0x317621)[_0x49dc('0x19')](_0x4a0fa4=>{_0x42e950(_0x48a895[_0x49dc('0x5')][_0x49dc('0x6')]['fromDto'](_0x36c1fd));});}});},'inflateDtos':function(_0x3a204e){return new Promise((_0xe30831,_0x5e3eb9)=>{var _0xbbcbec=_0x3a204e[_0x49dc('0x13')](_0x27a5d2=>{return _0x48a895['routines']['inflateDto'](_0x27a5d2);});Promise['all'](_0xbbcbec)[_0x49dc('0x19')](_0x37c2be=>{_0xe30831(_0x37c2be);});});}};return _0x23ce82();},'start':function(_0x3994e5,_0x2916ab){var _0x22c74c=Path[_0x49dc('0x1a')](_0x3994e5[_0x49dc('0x1b')][_0x49dc('0x1c')][_0x49dc('0x1d')]['db'][0x0],_0x3994e5[_0x49dc('0x3')][_0x49dc('0x1e')]);_0x3994e5[_0x49dc('0x1f')]('loading\x20routine\x20database\x20['+_0x22c74c+_0x49dc('0x20'),'debug');_0x3994e5['db']=_0x3994e5['db']||{};_0x3994e5['db'][_0x49dc('0x3')]=new Datastore({'filename':_0x22c74c,'autoload':!![]});_0x3994e5['db'][_0x49dc('0x3')][_0x49dc('0x21')]({'fieldName':'name','unique':!![]},_0x2e2725=>{if(_0x2e2725)_0x3994e5[_0x49dc('0x1f')](_0x2e2725,_0x49dc('0x22'));});_0x3994e5[_0x49dc('0x1f')](_0x49dc('0x23'),'info');return _0x2916ab();}};